select(exp_date, species, stages, well) %>%
mutate(dead = TRUE)
dead <- tidy_data %>%
filter(case_when(
time_point == '0hr' & stages == 'AF' & total_motility < female_cutoff ~ TRUE,
time_point == '0hr' & stages == 'AM' & total_motility < male_cutoff ~ TRUE,
)) %>%
# select(exp_date, species, stages, well) %>%
mutate(dead = TRUE)
View(dead)
library(tidyverse)
library(cowplot)
library(patchwork)
library(magick)
library(here)
# Figure 3 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig3/subplots/optimized_motility.rds')) +
theme(
# axis.title.x = element_blank(),
legend.position = 'empty')
b_metabolism <- read_rds(here('Fig3/subplots/heatkilled_metabolism.rds'))
c_fecundity <- read_rds(here('Fig3/subplots/optimized_fecundity.rds')) +
theme(legend.position = 'empty')
d_fecundity <- read_rds(here('Fig3/subplots/baseline_fecundity.rds')) +
theme(legend.position = 'right')
e_fecundity <- read_rds(here('Fig3/subplots/heatkilled_fecundity.rds'))
f_scheme <- image_read_pdf(here('Fig3/subplots/Fig3f.pdf'))
f <- ggdraw() + draw_image(f_scheme)
b_align <- cowplot::align_plots(c_fecundity, e_fecundity,
align = 'h', axis = 'b')
left <- plot_grid(a_motility, b_align[[1]],
align = 'v', axis = 'lr', rel_heights = c(1, 1.1),
nrow = 2, labels = c('a', 'c'), label_size = 12)
right <- plot_grid(b_metabolism, d_fecundity, b_align[[2]],
align = 'v', axis = 'l',
nrow = 3, labels = c('b', 'd', 'e'), label_size = 12, hjust = 0)
top <- plot_grid(left, right,
rel_widths = c(1.25, 1), ncol = 2)
fig3 <- plot_grid(
top, f, rel_heights = c(2.7, 1), nrow = 2, labels = c('', 'f'), label_size = 12)
save_plot(here('Fig3/Fig3.pdf'),
fig3, base_height = 7, base_width = 7)
save_plot(here('Fig3/Fig3.png'),
fig3, base_height = 7, base_width = 7)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
# Figure 4 ----------------------------------------------------------------
a_motility <- read_rds(here('Fig4/subplots/motility.rds')) +
theme(
axis.title.x = element_blank(),
legend.position = 'empty'
)
b_distinct_lines <- read_rds(here('Fig4/subplots/distinct_lines.rds'))
c_fecundity <- read_rds(here('Fig4/subplots/proportions.rds')) +
theme(
legend.position = 'empty'
)
c_inset <- read_rds(here('Fig4/subplots/baseline.rds')) +
theme(
axis.text.y =  element_markdown(size = 7),
axis.title.y = element_markdown(size = 9),
# axis.ticks.y = element_blank(),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
panel.background = element_rect(fill = 'white', colour = 'black', size = 0.25),
plot.background = element_rect(fill = NA, colour = NA)
)
c <- c_fecundity +
inset_element(c_inset,
left = 0.75, bottom = 0.5, right = 1, top = 1, align_to = 'full', ignore_tag = TRUE)
d_lactate <- read_rds(here('Fig4/subplots/lactate.rds')) +
theme(
legend.position = 'bottom'
)
e_viability <- image_read_pdf(here('Fig4/subplots/Fig4e.pdf'))
e <- ggdraw() + draw_image(e_viability)
legend <- get_legend(d_lactate)
# cowplot -----------------------------------------------------------------
left <- plot_grid(a_motility, c, d_lactate + theme(legend.position = 'empty'), legend,
nrow = 4, align = 'v', axis = 'l', rel_heights = c(1, 0.5, 1, 0.1),
labels = c('a', 'c', 'd'), label_size = 12)
right <- plot_grid(b_distinct_lines, e,
# scale = c(1, 1.05),
nrow = 2, rel_heights = c(1, 0.5),
# align = 'v', axis = 'lr',
labels = c('b', 'e'), label_size = 12)
fig4 <- plot_grid(left, right,
ncol = 2, rel_widths = c(1, 0.5))
save_plot(here('Fig4/Fig4.pdf'),
fig4, base_width = 8.66, base_height = 11)
save_plot(here('Fig4/Fig4.png'),
fig4, base_width = 8.66, base_height = 11)
library(tidyverse)
library(ggtext)
library(cowplot)
library(magick)
library(patchwork)
library(here)
conflict_prefer("filter", "dplyr")
# Figure 6 ----------------------------------------------------------------
cutoff <- -1
a_screen <- read_rds(here('Fig6/subplots/cel_screen_dev.rds')) +
labs(color = '') +
theme(legend.position = 'bottom',
axis.text.x = element_blank(),
axis.title.x = element_blank())
b_followup <- read_rds(here('Fig6/subplots/cel_followup.rds'))  +
scale_fill_manual(values = c("#FAD510", "#CB2314", '#00AFB5'), guide = 'none')
drug_label <- tibble(x = c(3.5, 1.5),
y = 1.7,
label = c('ML 228', 'NAV 2729'),
panel = c('ML 228', 'NAV 2729'))
c_deconvolution <- read_rds(here('Fig6/subplots/deconvolution.rds')) +
geom_text(data = drug_label, aes(x = x, y = y, label = label)) +
labs(fill = '') +
theme(
strip.text.x = element_blank(),
# axis.text.x = element_markdown(angle = 0, hjust = 0.5),
legend.position = 'right'
)
hypoxia <- image_read_pdf(here('Fig6/subplots/hypoxia_reporter.pdf'))
d_hypoxia <- ggdraw() +
draw_image(hypoxia)
e_iron <- read_rds(here('Fig6/subplots/k_s_media.rds'))
# cowplot -----------------------------------------------------------------
legend <- get_legend(a_screen)
(top <- plot_grid(a_screen, b_followup, axis = 't', align = 'h', rel_widths = c(0.85, 1),
labels = c('a', 'b'), label_size = 12))
bottom <- plot_grid(d_hypoxia, e_iron, axis = 't', align = 'h', rel_widths = c(0.65, 1),
labels = c('d', 'e'), label_x = c(0, -0.03), label_size = 12)
fig6 <- plot_grid(top, c_deconvolution, bottom, nrow = 3, labels = c('', 'c', ''),
rel_heights = c(1.15, 0.35, 0.5), label_y = 1.15, label_size = 12)
save_plot(here('Fig6/Fig6.pdf'),
fig6, base_width = 8, base_height = 8)
save_plot(here('Fig6/Fig6.png'),
fig6, base_width = 8, base_height = 8)
